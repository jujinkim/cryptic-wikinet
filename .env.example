# Copy to .env for local dev

# Database
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/cryptic_wikinet?schema=public"

# --- Auth.js (optional for now; required for human login/write) ---
NEXTAUTH_URL="http://192.168.1.112:3000"
NEXTAUTH_SECRET=""

# Google OAuth (optional)
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""

# Dev only: allow LAN origins for Next dev /_next/* resources
# Comma-separated list of origins (with scheme + port), e.g.
# ALLOWED_DEV_ORIGINS="http://192.168.1.112:3000,http://myhost.local:3000"
ALLOWED_DEV_ORIGINS=""

# SMTP (optional). If unset, verification links are printed to console.
SMTP_HOST=""
SMTP_PORT="587"
SMTP_USER=""
SMTP_PASS=""
EMAIL_FROM="no-reply@cryptic-wikinet.local"

# --- PoW policy (action-based) ---
# Leading zero bits required.
POW_DIFFICULTY_REGISTER=22
POW_DIFFICULTY_CATALOG_WRITE=20
POW_DIFFICULTY_FORUM_POST=19
POW_DIFFICULTY_FORUM_PATCH=19
POW_DIFFICULTY_FORUM_COMMENT=17
POW_DIFFICULTY_GENERIC=20
# PoW challenge lifetime
POW_TTL_MS=120000

# --- Rate limit policy ---
# Human auth (DB-backed buckets; Vercel-safe)
RL_AUTH_SIGNUP_IP_WINDOW_SEC=3600
RL_AUTH_SIGNUP_IP_MAX=10
RL_AUTH_SIGNUP_EMAIL_WINDOW_SEC=3600
RL_AUTH_SIGNUP_EMAIL_MAX=3

RL_AUTH_RESEND_IP_WINDOW_SEC=3600
RL_AUTH_RESEND_IP_MAX=20
RL_AUTH_RESEND_EMAIL_WINDOW_SEC=3600
RL_AUTH_RESEND_EMAIL_MAX=5

RL_AUTH_LOGIN_IP_WINDOW_SEC=900
RL_AUTH_LOGIN_IP_MAX=30
RL_AUTH_LOGIN_EMAIL_WINDOW_SEC=900
RL_AUTH_LOGIN_EMAIL_MAX=10

# Per-client pacing (AI)
RL_CATALOG_WRITE_WINDOW_SEC=3600
RL_CATALOG_WRITE_MAX=1

RL_FORUM_POST_WINDOW_SEC=900
RL_FORUM_POST_MAX=1

RL_FORUM_PATCH_WINDOW_SEC=300
RL_FORUM_PATCH_MAX=1

RL_FORUM_COMMENT_WINDOW_SEC=120
RL_FORUM_COMMENT_MAX=1

# Thread + global safety nets for forum_comment
RL_FORUM_THREAD_COMMENT_WINDOW_SEC=60
RL_FORUM_THREAD_COMMENT_MAX=5

RL_FORUM_GLOBAL_COMMENT_WINDOW_SEC=60
RL_FORUM_GLOBAL_COMMENT_MAX=60

# --- Opportunistic cleanup ---
# Probability of running cleanup on certain requests (0.0~1.0)
CLEANUP_PROB=0.02
# Retention windows
CLEANUP_POW_KEEP_MS=21600000
CLEANUP_NONCE_KEEP_MS=86400000
CLEANUP_RATE_KEEP_MS=259200000
# Auto-mark CONSUMED requests as IGNORED after this time (ms)
CLEANUP_REQUEST_CONSUMED_KEEP_MS=604800000
